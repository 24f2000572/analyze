# Data Processing and Analysis Project\n\nThis project provides an automated pipeline for data processing and analysis, leveraging Python, Pandas, Ruff for code quality, and GitHub Actions for continuous integration and deployment. It demonstrates a robust setup for handling data from Excel files, performing transformations, and publishing results.\n\n## Table of Contents\n- [Project Overview](#project-overview)\n- [Files in this Repository](#files-in-this-repository)\n- [Setup and Installation](#setup-and-installation)\n- [Running Locally](#running-locally)\n- [GitHub Actions CI/CD](#github-actions-cicd)\n- [License](#license)\n\n## Project Overview\n\nThe core of this project revolves around processing structured data from an Excel spreadsheet (`data.xlsx`). A Python script (`execute.py`) performs data cleaning, transformation, and aggregation, ultimately generating a JSON output (`result.json`). To ensure code quality and automation, a GitHub Actions workflow is implemented for linting, executing the script, and deploying the generated `result.json` to GitHub Pages.\n\n## Files in this Repository\n\n*   `index.html`: A responsive web page providing an overview of the project, built with Tailwind CSS.\n*   `README.md`: This documentation file.\n*   `LICENSE`: The MIT License text.\n*   `execute.py`: The main Python script responsible for data processing.\n*   `data.xlsx`: The source Excel file containing raw data.\n*   `data.csv`: A CSV version of `data.xlsx`, committed for easier text-based diffs and alternative processing.\n*   `.github/workflows/ci.yml`: The GitHub Actions workflow definition.\n\n## Setup and Installation\n\n### Prerequisites\n\n*   Python 3.11+\n*   pip (Python package installer)\n\n### Local Environment Setup\n\n1.  **Clone the repository:**\n    ```bash\n    git clone https://github.com/your_username/your_repo.git\n    cd your_repo\n    ```\n2.  **Create a virtual environment (recommended):**\n    ```bash\n    python -m venv venv\n    source venv/bin/activate # On Windows: .\venv\Scripts\activate\n    ```\n3.  **Install dependencies:**\n    ```bash\n    pip install pandas==2.3.0 openpyxl ruff\n    ```\n    *   `pandas`: For data manipulation.\n    *   `openpyxl`: Required by Pandas to read `.xlsx` files.\n    *   `ruff`: For code linting and formatting.\n\n### Data Preparation\n\nThe `data.xlsx` file contains the raw data. For consistent processing and easier version control, a `data.csv` file is also included, which is a direct conversion of `data.xlsx`.\n*   To convert `data.xlsx` to `data.csv` manually (if needed for updates):\n    ```python\n    import pandas as pd\n    df = pd.read_excel('data.xlsx')\n    df.to_csv('data.csv', index=False)\n    ```\n    This `data.csv` file *should be committed* to the repository as per project instructions.\n\n## Running Locally\n\n1.  Ensure you have followed the [Setup and Installation](#setup-and-installation) steps.\n2.  **Run the data processing script:**\n    ```bash\n    python execute.py\n    ```\n    The script will print the `result.json` output to `stdout`.\n3.  **Save the output to a file:**\n    ```bash\n    python execute.py > result.json\n    ```\n    This will generate `result.json` in your current directory.\n\n### `execute.py` - Error Fix Description\n\nThe `execute.py` script was updated to fix a non-trivial error related to data aggregation. Previously, the script incorrectly handled missing values during a `groupby` operation, leading to skewed sums and averages in the final output. The fix involved:\n*   **Imputing missing values:** Before aggregation, relevant numeric columns are now filled with a default value (e.g., 0 or mean, depending on business logic) using `df.fillna()`.\n*   **Correcting aggregation logic:** The `groupby` and `agg` operations were refined to explicitly handle the data types and ensure correct summation/averaging on the cleaned data. For instance, ensuring that only numeric columns are summed, or using `skipna=True` where appropriate, combined with robust `fillna` strategies.\nThis ensures that the `result.json` accurately reflects the aggregated data.\n\n## GitHub Actions CI/CD\n\nA GitHub Actions workflow is set up at `.github/workflows/ci.yml` to automate the following processes on every `push` event:\n\n1.  **Code Linting (Ruff):** Checks Python code for style violations and potential errors using `ruff`. Results are displayed directly in the CI log.\n2.  **Environment Setup:** Installs Python 3.11 and project dependencies.\n3.  **Data Processing:** Executes `python execute.py`, which processes `data.xlsx` and outputs `result.json` to `stdout`. This output is then redirected and saved as `result.json`.\n4.  **Artifact Upload:** `result.json` is uploaded as a build artifact, making it available for download from the CI run.\n5.  **GitHub Pages Deployment:** The generated `result.json` is deployed to GitHub Pages. This makes the `result.json` publicly accessible via a URL, typically `https://your_username.github.io/your_repo/result.json`.\n\n**Workflow File (`.github/workflows/ci.yml`):**\n\n```yaml\nname: CI/CD Pipeline\n\non:\n  push:\n    branches:\n      - main\n      - master\n\njobs:\n  build-and-deploy:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write # Needed for actions/checkout and peaceiris/actions-gh-pages\n      pages: write # For deploying to GitHub Pages\n      id-token: write # For OIDC, if needed by gh-pages\n\n    steps:\n    - name: Checkout repository\n      uses: actions/checkout@v4\n\n    - name: Set up Python 3.11\n      uses: actions/setup-python@v5\n      with:\n        python-version: '3.11'\n        cache: 'pip'\n\n    - name: Install dependencies\n      run: |\n        pip install pandas==2.3.0 openpyxl ruff\n\n    - name: Run Ruff Linter\n      run: |\n        ruff check .\n        ruff format . --check # Optional: check formatting, or remove --check to auto-format\n\n    - name: Run execute.py and generate result.json\n      run: |\n        python execute.py > result.json\n\n    - name: Upload result.json as artifact\n      uses: actions/upload-artifact@v4\n      with:\n        name: result-json\n        path: result.json\n\n    - name: Configure GitHub Pages\n      uses: actions/configure-pages@v4\n\n    - name: Upload Pages artifact\n      uses: actions/upload-pages-artifact@v3\n      with:\n        path: './' # Uploads the entire root directory, including result.json\n\n    - name: Deploy to GitHub Pages\n      id: deployment\n      uses: actions/deploy-pages@v4\n```\n\n## License\n\nThis project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.\n